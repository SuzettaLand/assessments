<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attachment Style Assessment</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .question {
            margin-bottom: 20px;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .question-text {
            margin-bottom: 10px;
        }
        .options {
            display: flex;
            gap: 20px;
        }
        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #submitBtn {
            width: 100%;
            padding: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        #submitBtn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        #submitBtn:hover:not(:disabled) {
            background-color: #0056b3;
        }
        #results {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Attachment Style Assessment</h1>
        <form id="assessmentForm">
            <div id="questionsContainer"></div>
            <button type="button" id="submitBtn" disabled>Please answer all questions (0/28)</button>
        </form>
        <div id="results">
            <h2>Your Results</h2>
            <p id="dominantStyle"></p>
            <div id="scoreBreakdown"></div>
        </div>
    </div>

    <script>
        const questions = [
            "I deeply fear being abandoned by my partner or love interests.",
            "I tend to be out of touch with my emotions quite frequently.",
            "I can be very emotionally present with others (friends, family, partners, strangers), but it takes me a while to build trust and share vulnerable things about myself.",
            "I constantly want to be emotionally closer to my partner. This can also apply to my close friendships or romantic interests.",
            "I find that my partner or loved ones usually emotionally recover from conflict before I do.",
            "I am very attuned to others' needs and often put them before my own and resent it later.",
            "I know that I am worthy of a healthy, happy relationship.",
            "It is not uncommon for me to experience inward emotional turbulence throughout the duration of my romantic relationship. This applies to close family members as well.",
            "If a loved one's behavior hurts me, I will express my feelings and try to understand what caused them to act that way.",
            "When I feel hurt by a loved one, I often have a strong fight or flight response. I find myself wanting to push this person as far away as possible.",
            "I often put other people (partner, family, friends) in my life on a big pedestal.",
            "I often feel protective over my space, privacy and belongings.",
            "If I notice my partner showing any signs of coldness, I panic and want to get closer as quickly as possible. This often happens to me in friendships as well.",
            "It is very difficult for me to set boundaries unless I am angry. I can sometimes set excessive boundaries and push people away too dramatically out of anger.",
            "I am willing to work through challenges in a relationship before suddenly trying to leave the relationship itself.",
            "I do not enjoy being out of romantic relationships. I often fear being alone.",
            "I feel very upset when others infringe on my need for space or time alone.",
            "I focus much more on the relationships in my life than I do on myself.",
            "I do not feel as though I need anything from my romantic partner or loved ones. It can be difficult to conceptualize how others would meet a lot of my needs.",
            "I often feel very hot or very cold towards my partner or family members. I tend to operate in extremes in how I relate to others.",
            "I generally feel invaded when my partner or loved ones demand too much physical affection.",
            "I feel naturally comfortable and safe expressing my feelings and needs to loved ones.",
            "I would prefer to spend most of my free time with my partner if I were to be in a romantic relationship. It would be hard for me to want to do things separately.",
            "I am effective at compromising and communicating.",
            "I do not like making social plans with others in advance. I often fear being trapped by commitments with other people.",
            "I find that setting boundaries comes naturally to me.",
            "I feel that it is easy to be vulnerable with my romantic partner or loved ones.",
            "I hunger for closeness, but I fear the emotional difficulty of it at the same time (friends, family, romantic partners)."
        ];

        const categoryMapping = {
            FA: [2, 5, 7, 9, 13, 19, 27],    // Fearful Avoidant
            AP: [0, 3, 10, 12, 15, 17, 22],  // Anxious Preoccupied
            DA: [1, 4, 11, 16, 18, 20, 24],  // Dismissive Avoidant
            S: [6, 8, 14, 21, 23, 25, 26]    // Secure
        };

        const styleNames = {
            FA: "Fearful Avoidant (FA)",
            AP: "Anxious Preoccupied (AP)",
            DA: "Dismissive Avoidant (DA)",
            S: "Secure (S)"
        };

        // Initialize the form
        const questionsContainer = document.getElementById('questionsContainer');
        const submitBtn = document.getElementById('submitBtn');
        const results = document.getElementById('results');
        let answers = {};

        // Create questions
        questions.forEach((question, index) => {
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question';
            questionDiv.innerHTML = `
                <div class="question-text">
                    <strong>${index + 1}.</strong> ${question}
                </div>
                <div class="options">
                    <label class="radio-option">
                        <input type="radio" name="question${index}" value="yes"> Yes
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="question${index}" value="no"> No
                    </label>
                </div>
            `;
            questionsContainer.appendChild(questionDiv);
        });

        // Handle radio button changes
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                const questionIndex = parseInt(e.target.name.replace('question', ''));
                answers[questionIndex] = e.target.value === 'yes';
                updateSubmitButton();
            });
        });

        function updateSubmitButton() {
            const answeredCount = Object.keys(answers).length;
            submitBtn.disabled = answeredCount < questions.length;
            submitBtn.textContent = answeredCount < questions.length ? 
                `Please answer all questions (${answeredCount}/${questions.length})` : 
                'Show Results';
        }

        function calculateResults() {
            const scores = {
                FA: 0,
                AP: 0,
                DA: 0,
                S: 0
            };

            Object.entries(categoryMapping).forEach(([category, questionIndices]) => {
                questionIndices.forEach(index => {
                    if (answers[index] === true) {
                        scores[category]++;
                    }
                });
            });

            const maxScore = Math.max(...Object.values(scores));
            const dominantStyles = Object.entries(scores)
                .filter(([_, score]) => score === maxScore)
                .map(([style]) => styleNames[style]);

            return {
                scores,
                dominant: dominantStyles.join(' / ')
            };
        }

        submitBtn.addEventListener('click', () => {
            const result = calculateResults();
            
            // Display results on current page
            document.getElementById('results').style.display = 'block';
            document.getElementById('dominantStyle').textContent = `Your dominant attachment style is: ${result.dominant}`;
            
            const scoreBreakdown = document.getElementById('scoreBreakdown');
            scoreBreakdown.innerHTML = '';
            Object.entries(result.scores).forEach(([style, score]) => {
                const scoreDiv = document.createElement('div');
                scoreDiv.className = 'score-item';
                scoreDiv.innerHTML = `
                    <span>${styleNames[style]}</span>
                    <span>${score} Yes responses</span>
                `;
                scoreBreakdown.appendChild(scoreDiv);
            });

            // Encode results for URL
            const resultsParam = encodeURIComponent(JSON.stringify({
                dominant: result.dominant,
                scores: result.scores
            }));

            // Redirect to results page with parameters
            window.location.href = 'https://suzettaland.github.io/assessments/index.html?attachment=' + resultsParam;
        });
    </script>
</body>
</html>